<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics - Admin Dashboard</title>
    <link rel="stylesheet" href="../css/admin.css"> <!-- Link to your admin CSS file -->
    <script src="https://www.gstatic.com/firebasejs/9.8.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.8.2/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.8.2/firebase-firestore.js"></script>
    <script src="../js/firebaseConfig.js"></script> <!-- Your Firebase config -->
    <script src="../js/admin.js"></script> <!-- Link to your admin JS file -->
</head>
<body>
    <div class="container">
        <header>
            <h1>Admin Analytics Dashboard</h1>
            <nav>
                <ul>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="design.html">Design</a></li>
                    <li><a href="images.html">Images</a></li>
                    <li><a href="purchases.html">Purchases</a></li>
                    <li><a href="appointments.html">Appointments</a></li>
                    <li><a href="settings.html">Settings</a></li>
                    <li><a href="../index.html">Back to Site</a></li>
                </ul>
            </nav>
        </header>

        <main>
            <section id="analytics-data">
                <h2>Analytics Overview</h2>
                <div class="metric">
                    <h3>Total Page Views</h3>
                    <p id="total-page-views">Loading...</p>
                </div>
                <div class="metric">
                    <h3>Popular Images</h3>
                    <ul id="popular-images">Loading...</ul>
                </div>
            </section>
        </main>

        <footer>
            <p>&copy; 2024 Raw Photography. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const analytics = firebase.analytics();
        const db = firebase.firestore();

        // Function to fetch and display analytics data
        async function fetchAnalytics() {
            try {
                const analyticsRef = db.collection('analytics').doc('siteMetrics');
                const doc = await analyticsRef.get();

                if (doc.exists) {
                    const data = doc.data();
                    document.getElementById('total-page-views').innerText = data.pageViews;

                    // Display popular images
                    const popularImagesList = document.getElementById('popular-images');
                    popularImagesList.innerHTML = ''; // Clear the list

                    data.popularImages.forEach(imageId => {
                        const listItem = document.createElement('li');
                        listItem.innerText = imageId; // Fetch and display image details as needed
                        popularImagesList.appendChild(listItem);
                    });
                } else {
                    console.error('No such document!');
                }
            } catch (error) {
                console.error('Error fetching analytics data:', error);
            }
        }

        // Call fetchAnalytics on page load
        window.onload = function() {
            fetchAnalytics();
        };
    </script>
</body>
</html>
